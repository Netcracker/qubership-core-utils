name: Deploy on push

run-name: >
  Deploy â€”
  ${{ github.event_name == 'workflow_dispatch' && 'manual' || 'push' }} (${{ github.ref_name }})
  ${{ github.event_name == 'push' && format('[{0}]', github.event.head_commit.message) || '' }}

on:
  push:
    branches:
      - main
      - feat/monorepo-workflows
  workflow_dispatch:

jobs:
  deploy-on-push:
    name: Maven build and deploy
    uses: Netcracker/qubership-core-infra/.github/workflows/generic-maven-build.yaml@feat/monorepo-workflows
    with:
      maven-command: 'deploy'
      upload-artifact: true
      sonar-project-key: ${{ vars.SONAR_PROJECT_KEY }}
      ref: ${{ github.ref }}
    secrets: inherit

